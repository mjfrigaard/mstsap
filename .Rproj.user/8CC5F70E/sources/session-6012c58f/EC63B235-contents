shiny::testServer(mod_dataset_server, expr = {
  session$setInputs(dataset = "faithful")
  testthat::expect_equal(
    object = input$dataset,
    expected = "faithful")
  cat("\n\tmod_dataset_server: dataset$input", "\n")

  session$setInputs(dataset = "mtcars")
  testthat::expect_true(
    object = is.data.frame(session$returned()))
  cat("\n\tmod_dataset_server is.data.frame()", "\n")

  session$setInputs(dataset = "mtcars")
  expect_equal(object = names(session$returned()),
    expected = names(mtcars))
  cat("\n\tmod_dataset_server names()", "\n")
})
